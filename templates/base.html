{% load static tailwind_tags i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 'bumblebee';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <title>{% block title %}Django ATHM - ATH Móvil Payment Integration for Django{% endblock %}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    {% block meta_description %}
    <meta name="description" content="Django ATHM enables ATH Móvil payment integration for Django applications. Sync transactions via webhooks with auto-persistence, admin dashboard, and Django signals.">
    {% endblock %}

    {% block meta_robots %}{% endblock %}

    <link rel="canonical" href="https://django-athm.dev{{ request.path }}">

    <link rel="alternate" hreflang="en" href="https://django-athm.dev/en/">
    <link rel="alternate" hreflang="es" href="https://django-athm.dev/es/">
    <link rel="alternate" hreflang="x-default" href="https://django-athm.dev/en/">

    {% block meta_tags %}{% endblock %}

    <link rel="icon" type="image/png" href="{% static 'images/logo.png' %}">
    {% tailwind_css %}

    {% block extra_scripts %}{% endblock %}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    {% block extra_css %}{% endblock %}

    <script async src="https://analytics.kuribosoft.com/js/pa-hiEVQxxH0x5AkmCUQHQlK.js"></script>
    <script>window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};plausible.init()</script>
</head>

<body>
    {% include 'partials/_header.html' %}

    {% block body %}
        {% block content %}{% endblock %}
    {% endblock %}

    {% block footer %}{% endblock %}

    {% include 'partials/_toasts.html' %}

    <script>
        (function() {
            function syncATHMTheme(theme) {
                const athmTheme = theme === 'coffee' ? 'btn-dark' : 'btn';
                document.querySelectorAll('.athm-button').forEach(function(btn) {
                    btn.classList.remove('athm-btn', 'athm-btn-dark', 'athm-btn-light');
                    btn.classList.add('athm-' + athmTheme);
                });
            }

            const themeController = document.querySelector('.theme-controller');
            if (themeController) {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'coffee') {
                    themeController.checked = true;
                }

                themeController.addEventListener('change', function() {
                    const theme = this.checked ? 'coffee' : 'bumblebee';
                    localStorage.setItem('theme', theme);
                    document.documentElement.setAttribute('data-theme', theme);
                    syncATHMTheme(theme);
                });
            }

            // Sync ATHM theme on initial load (after buttons render)
            const savedTheme = localStorage.getItem('theme') || 'bumblebee';
            if (savedTheme === 'coffee') {
                syncATHMTheme(savedTheme);
            }
        })();
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
