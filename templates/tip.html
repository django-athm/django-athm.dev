{% extends "base.html" %}
{% load static django_athm i18n %}

{% block title %}Django ATHM - ATH Móvil Payment Integration for Django | Webhooks, Signals & Admin Dashboard{% endblock %}

{% block meta_description %}
<meta name="description" content="Accept ATH Móvil payments in your Django application. Django ATHM provides webhook integration, automatic transaction persistence, Django signals, admin dashboard, and one-click refunds. Python 3.10-3.14, Django 5.1+ compatible.">
{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <div class="min-h-[85vh] flex items-center relative overflow-hidden">
        <div class="container mx-auto px-4 sm:px-6 py-20 relative z-10">
            <div class="max-w-4xl">
                <div class="flex items-center gap-2 sm:gap-3 mb-8">
                    <img src="{% static 'images/logo.png' %}" alt="Django ATHM" class="w-12 h-12 sm:w-14 sm:h-14">
                    {% blocktrans trimmed %}
                    <div class="badge badge-primary badge-md sm:badge-lg text-xs sm:text-sm font-semibold py-3"><a href="https://djangopackages.org/packages/p/django-athm/" target="_blank">Django Package</a></div>
                    {% endblocktrans %}
                </div>

                <h1 class="text-5xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight">
                    {% trans "ATH Móvil payments" %}<br>
                    {% trans "for Django" %}
                </h1>

                <p class="text-lg sm:text-xl md:text-2xl text-base-content/70 mb-4 max-w-2xl">
                    {% trans "Sync ATH Móvil transactions to your Django database via webhooks. Auto-persistence, admin dashboard, and signals included." %}
                </p>

                <div class="text-sm text-base-content/50 mb-10">
                    {% blocktrans trimmed %}
                        <p>This is an unofficial, community-maintained package. </p>
                        <p><strong>Not</strong> affiliated with  <a class="text-accent" target="_blank" href="https://evertecinc.com/">Evertec, Inc.</a> or <a class="text-accent" target="_blank" href="https://portal.athmovil.com/">ATH Móvil</a> in any way.<p>
                    {% endblocktrans %}

                </div>

                <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 mb-12">
                    <a href="https://django-athm.readthedocs.io" target="_blank"
                       class="btn btn-primary btn-lg w-full sm:w-auto shadow-lg hover:shadow-xl transition-shadow">
                        {% trans "Read Documentation" %}
                    </a>
                    <a href="https://github.com/django-athm/django-athm" target="_blank"
                       class="btn btn-secondary btn-lg w-full sm:w-auto">
                        {% trans "View on GitHub" %}
                    </a>
                </div>

                <!-- Quick stats -->
                <div class="flex flex-col sm:flex-row sm:flex-wrap gap-2 sm:gap-6 md:gap-8 text-sm">
                    <div class="flex items-center gap-1.5 sm:gap-2">
                        <div class="w-1.5 h-1.5 sm:w-2 sm:h-2 bg-success rounded-full"></div>
                        <span class="text-base-content/60">{% trans "Python 3.10 - 3.14" %}</span>
                    </div>
                    <div class="flex items-center gap-1.5 sm:gap-2">
                        <div class="w-1.5 h-1.5 sm:w-2 sm:h-2 bg-success rounded-full"></div>
                        <span class="text-base-content/60">{% trans "Django 5.1 - 6.0" %}</span>
                    </div>
                    <div class="flex items-center gap-1.5 sm:gap-2">
                        <div class="w-1.5 h-1.5 sm:w-2 sm:h-2 bg-success rounded-full"></div>
                        <span class="text-base-content/60">{% trans "Latest ATH Móvil API" %}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Live Demo Section -->
    <div class="py-16 sm:py-20 md:py-24 bg-base-200">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="max-w-5xl mx-auto">
                <!-- Section Header -->
                <div class="text-center mb-12">
                    <div class="badge badge-ghost mb-4">{% trans "Optional Quick-Start" %}</div>
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4">
                        {% trans "Try it yourself" %}
                    </h2>
                    <p class="text-lg text-base-content/60 max-w-2xl mx-auto">
                        {% trans "The included template tag provides a pre-built payment button for quick integration." %}
                    </p>
                </div>

                <!-- Main Content: Responsive Card -->
                <div class="card lg:card-side bg-base-100 shadow-xl">
                    <!-- Left: Payment Demo -->
                    <div class="card-body lg:w-2/5">
                        <h3 class="card-title text-2xl">{% trans "Support the Project" %}</h3>

                        <!-- Stat for amount -->
                        <div class="stats bg-base-200 my-4">
                            <div class="stat">
                                <div class="stat-title">{% trans "Tip Amount" %}</div>
                                <div class="stat-value text-primary">$3.00</div>
                                <div class="stat-desc">{% trans "Supporting Django ATHM development" %}</div>
                            </div>
                        </div>

                        <!-- Payment Button (PRESERVED) -->
                        <div id="athm-button-wrapper" class="flex justify-center my-4">
                            {% include 'partials/athm_button.html' %}
                        </div>

                        <!-- Alert for real payment warning -->
                        <div role="alert" class="alert mt-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <div class="font-bold text-sm">{% trans "Real payment" %}</div>
                                <div class="text-xs">{% trans "Approving this transaction will charge $3.00 to your account. Thanks for supporting the project!" %}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Code Preview -->
                    <div class="bg-neutral lg:w-3/5 lg:rounded-r-box">
                        <div class="mockup-code bg-neutral text-neutral-content shadow-none text-sm">
                            <pre data-prefix="1" class="text-neutral-content/60"><code>{% verbatim %}# views.py{% endverbatim %}</code></pre>
                            <pre data-prefix="2"><code>def tip_page(request):</code></pre>
                            <pre data-prefix="3"><code>    context = {</code></pre>
                            <pre data-prefix="4"><code>        "ATHM_CONFIG": {</code></pre>
                            <pre data-prefix="5" class="text-success"><code>            "total": 3.00,</code></pre>
                            <pre data-prefix="6"><code>            "subtotal": 3.00,</code></pre>
                            <pre data-prefix="7"><code>            "tax": 0.00,</code></pre>
                            <pre data-prefix="8"><code>            # ...</code></pre>
                            <pre data-prefix="9"><code>        }</code></pre>
                            <pre data-prefix="10"><code>    }</code></pre>
                            <pre data-prefix="11"><code>    return render(...)</code></pre>
                            <pre data-prefix="12" class="text-neutral-content/40"><code></code></pre>
                            <pre data-prefix="13" class="text-neutral-content/60"><code>{% verbatim %}{# tip.html #}{% endverbatim %}</code></pre>
                            <pre data-prefix="14"><code>{% verbatim %}{% load django_athm %}{% endverbatim %}</code></pre>
                            <pre data-prefix="15" class="text-warning"><code>{% verbatim %}{% athm_button ATHM_CONFIG %}{% endverbatim %}</code></pre>
                        </div>
                        <div class="pb-4 text-center">
                            <a href="https://django-athm.readthedocs.io" target="_blank" class="link link-hover text-xs text-neutral-content/50">
                                {% trans "View full code in documentation" %}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Grid -->
    <div class="py-16 sm:py-20 md:py-24">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="max-w-6xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4">
                        {% trans "Everything you need" %}
                    </h2>
                    <p class="text-lg text-base-content/60 max-w-2xl mx-auto">
                        {% trans "Developed for Django users who want payment integration without the complexity." %}
                    </p>
                </div>

                <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                    {% include 'partials/_feature_card.html' with title=_("Auto-Persistence") description=_("Transactions, items, and customers automatically saved to your database on callback.") icon_path="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4" %}
                    {% include 'partials/_feature_card.html' with title=_("Django Admin Ready") description=_("Read-only dashboard with search, filtering, batch refunds, and webhook management.") icon_path="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z" %}
                    {% include 'partials/_feature_card.html' with title=_("Django Signals") description=_('Four signals: <code class="text-xs bg-base-200 px-1 rounded">payment_completed</code>, <code class="text-xs bg-base-200 px-1 rounded">payment_cancelled</code>, <code class="text-xs bg-base-200 px-1 rounded">payment_expired</code>, <code class="text-xs bg-base-200 px-1 rounded">refund_sent</code>.') icon_path="M13 10V3L4 14h7v7l9-11h-7z" %}
                    {% include 'partials/_feature_card.html' with title=_("One-Click Refunds") description=_("Process full or partial refunds directly from Django Admin with batch support.") icon_path="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" %}
                    {% include 'partials/_feature_card.html' with title=_("Webhook Events") description=_("Automatic webhook handling with idempotency keys. Events logged and deduplicated.") icon_path="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.14 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0" %}
                    {% include 'partials/_feature_card.html' with title=_("Transaction Sync") description=_('Reconcile with ATH Móvil via <code class="text-xs bg-base-200 px-1 rounded">athm_sync</code> management command.') icon_path="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" %}
                </div>
            </div>
        </div>
    </div>

    <!-- Code Examples -->
    <div class="py-16 sm:py-20 md:py-24 bg-base-200">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4">
                        {% trans "Purpose built for Django" %}
                    </h2>
                    <p class="text-lg text-base-content/60">
                        {% trans "Familiar patterns with batteries included." %}
                    </p>
                </div>

                <div class="space-y-8">
                    <!-- Signal Example -->
                    <div class="card bg-base-100 shadow-xl overflow-hidden">
                        <div class="p-4 bg-base-300/50 border-b border-base-300">
                            <span class="font-semibold">{% trans "Handle payment events with signals" %}</span>
                        </div>
                        <div class="mockup-code rounded-none bg-neutral">
                            <pre data-prefix="1" class="text-neutral-content/50"><code># signals.py</code></pre>
                            <pre data-prefix="2"><code>from django.dispatch import receiver</code></pre>
                            <pre data-prefix="3"><code>from django_athm.signals import payment_completed</code></pre>
                            <pre data-prefix="4"><code></code></pre>
                            <pre data-prefix="5"><code>@receiver(payment_completed)</code></pre>
                            <pre data-prefix="6"><code>def handle_payment(sender, payment, **kwargs):</code></pre>
                            <pre data-prefix="7" class="text-success"><code>    # Send confirmation email</code></pre>
                            <pre data-prefix="8" class="text-success"><code>    # Update inventory</code></pre>
                            <pre data-prefix="9" class="text-success"><code>    # Trigger fulfillment</code></pre>
                            <pre data-prefix="10"><code>    send_receipt(payment.customer_email, payment)</code></pre>
                        </div>
                    </div>

                    <!-- Webhook Events Example -->
                    <div class="card bg-base-100 shadow-xl overflow-hidden">
                        <div class="p-4 bg-base-300/50 border-b border-base-300">
                            <span class="font-semibold">{% trans "Query webhook events with automatic deduplication" %}</span>
                        </div>
                        <div class="mockup-code rounded-none bg-neutral">
                            <pre data-prefix="1"><code>from django_athm.models import WebhookEvent</code></pre>
                            <pre data-prefix="2"><code></code></pre>
                            <pre data-prefix="3" class="text-neutral-content/50"><code># Get all processed webhook events</code></pre>
                            <pre data-prefix="4"><code>WebhookEvent.objects.filter(</code></pre>
                            <pre data-prefix="5" class="text-success"><code>    event_type="ecommerce_completed",</code></pre>
                            <pre data-prefix="6" class="text-success"><code>    processed=True</code></pre>
                            <pre data-prefix="7"><code>)</code></pre>
                            <pre data-prefix="8"><code></code></pre>
                            <pre data-prefix="9" class="text-neutral-content/50"><code># Events: ecommerce_completed, ecommerce_cancelled,</code></pre>
                            <pre data-prefix="10" class="text-neutral-content/50"><code># ecommerce_expired, payment, refund</code></pre>
                        </div>
                    </div>

                    <!-- Transaction Sync Example -->
                    <div class="card bg-base-100 shadow-xl overflow-hidden">
                        <div class="p-4 bg-base-300/50 border-b border-base-300">
                            <span class="font-semibold">{% trans "Reconcile transactions with ATH Móvil" %}</span>
                        </div>
                        <div class="mockup-code rounded-none bg-neutral">
                            <pre data-prefix="$" class="text-warning"><code>python manage.py athm_sync \</code></pre>
                            <pre data-prefix=">" class="text-warning"><code>  --from-date 2025-01-01 \</code></pre>
                            <pre data-prefix=">" class="text-warning"><code>  --to-date 2025-01-31</code></pre>
                            <pre data-prefix="" class="text-neutral-content/40"><code></code></pre>
                            <pre data-prefix="1" class="text-neutral-content/50"><code># Query customer history</code></pre>
                            <pre data-prefix="2"><code>from django_athm.models import Client</code></pre>
                            <pre data-prefix="3"><code></code></pre>
                            <pre data-prefix="4"><code>client = Client.objects.get(phone="7871234567")</code></pre>
                            <pre data-prefix="5" class="text-success"><code>payments = client.payment_set.all()</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- How It Works -->
    <div class="py-16 sm:py-20 md:py-24">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4">
                        {% trans "How it works" %}
                    </h2>
                </div>

                <ul class="steps steps-vertical lg:steps-horizontal w-full">
                    <li class="step step-primary" data-content="1">
                        <div class="text-left lg:text-center py-4">
                            <h3 class="font-bold">{% trans "Install" %}</h3>
                            <p class="text-sm text-base-content/60">pip install django-athm</p>
                        </div>
                    </li>
                    <li class="step step-primary" data-content="2">
                        <div class="text-left lg:text-center py-4">
                            <h3 class="font-bold">{% trans "Configure" %}</h3>
                            <p class="text-sm text-base-content/60">{% trans "Add API keys and app to settings" %}</p>
                        </div>
                    </li>
                    <li class="step step-primary" data-content="3">
                        <div class="text-left lg:text-center py-4">
                            <h3 class="font-bold">{% trans "Install Webhooks" %}</h3>
                            <p class="text-sm text-base-content/60">{% trans "Via Admin or manage.py command" %}</p>
                        </div>
                    </li>
                    <li class="step step-primary" data-content="4">
                        <div class="text-left lg:text-center py-4">
                            <h3 class="font-bold">{% trans "Done" %}</h3>
                            <p class="text-sm text-base-content/60">{% trans "Transactions sync to your DB automatically" %}</p>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
{% endblock %}

{% block footer %}
    <!-- Footer CTA -->
    <footer class="py-16 sm:py-20 md:py-24 bg-base-300">
        <div class="container mx-auto px-4 sm:px-6 text-center">
            <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-6 text-base-content">
                {% trans "Ready to integrate ATH Móvil payments into your Django app?" %}
            </h2>
            <p class="text-lg text-base-content/80 mb-8 max-w-xl mx-auto">
                {% trans "Get started in minutes with our comprehensive documentation." %}
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="https://django-athm.readthedocs.io" target="_blank"
                   class="btn btn-lg btn-primary w-full sm:w-auto">
                    {% trans "Read Documentation" %}
                </a>
                <a href="https://github.com/django-athm/django-athm" target="_blank"
                   class="btn btn-lg btn-secondary w-full sm:w-auto">
                    {% trans "Star on GitHub" %}
                </a>
            </div>
        </div>
    </footer>

    <!-- Disclaimer -->
    <div class="py-8 bg-base">
        <div class="container mx-auto px-6 text-center space-y-6">
            <p class="text-sm text-base-content/50 max-w-3xl mx-auto">
                {% blocktrans trimmed %}
                This project is <strong>not</strong> affiliated with or endorsed by <a class="text-accent" target="_blank" href="https://evertecinc.com/">Evertec, Inc.</a> or <a class="text-accent" target="_blank" href="https://portal.athmovil.com/">ATH Móvil</a> in any way.
                {% endblocktrans %}
            </p>
            <a href="https://github.com/django-athm/demo" target="_blank" class="btn btn-accent">{% trans "View this page's source code" %}</a>
        </div>
    </div>

    <webring-css site="https://django-athm.dev"></webring-css>
{% endblock %}

{% block extra_js %}
    <script src="https://djangowebring.com/static/webring.js"></script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Django ATHM",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Cross-platform",
        "description": "ATH Móvil payment integration library for Django applications with webhook support, automatic transaction persistence, Django signals, and admin dashboard.",
        "url": "https://django-athm.dev",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "softwareVersion": "Latest",
        "programmingLanguage": {
            "@type": "ComputerLanguage",
            "name": "Python"
        },
        "softwareRequirements": "Python 3.10-3.14, Django 5.1+",
        "codeRepository": "https://github.com/django-athm/django-athm",
        "author": {
            "@type": "Organization",
            "name": "Django ATHM",
            "url": "https://django-athm.dev"
        },
        "inLanguage": ["en", "es"],
        "keywords": "django, ath móvil, payment integration, puerto rico, webhook, ecommerce, django package"
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "Integrate ATH Móvil payments in Django",
        "description": "Step-by-step guide to integrate ATH Móvil payment processing in your Django application",
        "step": [
            {
                "@type": "HowToStep",
                "name": "Install",
                "text": "Install the django-athm package using pip install django-athm",
                "position": 1
            },
            {
                "@type": "HowToStep",
                "name": "Configure",
                "text": "Add API keys to your Django settings file",
                "position": 2
            },
            {
                "@type": "HowToStep",
                "name": "Install Webhooks",
                "text": "Set up webhooks via Django Admin or manage.py command",
                "position": 3
            },
            {
                "@type": "HowToStep",
                "name": "Done",
                "text": "Transactions sync automatically to your database",
                "position": 4
            }
        ],
        "totalTime": "PT10M"
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Django ATHM",
        "url": "https://django-athm.dev",
        "description": "ATH Móvil payment integration for Django applications",
        "inLanguage": ["en", "es"],
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://django-athm.readthedocs.io/en/latest/search.html?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
{% endblock %}
